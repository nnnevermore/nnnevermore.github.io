<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>WTG安装和初始化</title>
    <url>/2020/04/08/WTG%E5%AE%89%E8%A3%85%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
    <content><![CDATA[<p><a href="https://docs.microsoft.com/en-us/windows/deployment/planning/windows-to-go-overview" target="_blank" rel="noopener">WTG（windows to go）</a>是什么，想必不用多做介绍。下面是安装和配置的过程。</p>
<p>WTG的制作过程，有很多种方案：</p>
<ol>
<li>官方工具</li>
<li>Rufus</li>
<li>WTGA（WTG助手，国产开源）</li>
<li>AOMEI Partition Assistant</li>
</ol>
<p>具体用法就不赘述了，自行google即可。其中，1和2只有在制作WTG的宿主系统（也就是本机的系统）为windows10才有效，3和4都支持在win7上制作更高版本的WTG系统。不过有一点需要注意：制作过程中需要windows镜像中的install.wim文件（在source目录）。但是，如果使用<a href="https://www.microsoft.com/zh-cn/software-download/windows10" target="_blank" rel="noopener">Microsoft官方工具</a>（运行工具之后有直接下载iso文件的选项）下载的iso文件的话，目前的最新版本是没有install.wim了，取而代之的是一个install.esd文件，而WTGA虽然号称支持esd文件，但是实际使用过程中却造成失败。AOMEI则只支持install.wim。所以必须的已不是将esd文件转换为wim文件，这一步可以通过<a href="https://www.chuyu.me/zh-Hans/" target="_blank" rel="noopener">dism++</a>可以很方便转换。</p>
<h2 id="初始化设置"><a href="#初始化设置" class="headerlink" title="初始化设置"></a>初始化设置</h2><p>安装好系统后，配置一下，使其更加易用。</p>
<h3 id="shadowsocks"><a href="#shadowsocks" class="headerlink" title="shadowsocks"></a><code>shadowsocks</code></h3><p>客户端备份: <a href="/2020/04/08/WTG%E5%AE%89%E8%A3%85%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96/ShadowsocksR-win-4.9.1.zip" title="ShadowsocksR-win-4.9.1.zip">ShadowsocksR-win-4.9.1.zip</a></p>
<p>配置好后记得开启本地http代理</p>
<h3 id="utools"><a href="#utools" class="headerlink" title="utools"></a><a href="https://www.u.tools/" target="_blank" rel="noopener"><code>utools</code></a></h3><p>方便易用，风头正劲的新型软件。</p>
<h3 id="scoop"><a href="#scoop" class="headerlink" title="scoop"></a><a href="https://scoop.sh/" target="_blank" rel="noopener"><code>scoop</code></a></h3><p>安装步骤：</p>
<ol>
<li>打开powershell</li>
<li>执行 <code>Set-ExecutionPolicy RemoteSigned -scope CurrentUser</code></li>
<li>执行 <code>Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&#39;https://get.scoop.sh&#39;)</code> 或者简短版本 <code>iwr -useb get.scoop.sh | iex</code>.</li>
</ol>
<p>安装完scoop后，首先安装两个包：<code>7zip</code>和<code>git</code>, scoop会自动使用系统代理，配置了ss的话，速度应该比较正常。<br>git安装好后，设置代理：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy 'http://127.0.0.1:1080'</span><br><span class="line">git config --global https.proxy 'https://127.0.0.1:1080'</span><br></pre></td></tr></table></figure>
<p>或sock5代理：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy 'sock5://127.0.0.1:1080'</span><br><span class="line">git config --global https.proxy 'sock5://127.0.0.1:1080'</span><br></pre></td></tr></table></figure>
<p>之后可以添加几个bucket:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bear            (scoop bucket add bear https://github.com/AStupidBear/scoop-bear)                             </span><br><span class="line">extras                                       </span><br><span class="line">java                                         </span><br><span class="line">main                                         </span><br><span class="line">TheRandomLabs   (scoop bucket add TheRandomLabs https://github.com/TheRandomLabs/Scoop-Bucket.git)                            </span><br><span class="line">versions</span><br></pre></td></tr></table></figure>

<p>之后，安装其他工具，如果安装了aria2的话，scoop会调用它来下载，具体可以配置，目前已安装的包列表如下：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">PS C:\Data\Blog\nevermore&gt; scoop list      </span><br><span class="line">Installed apps:                            </span><br><span class="line">                                           </span><br><span class="line">  <span class="number">7</span>zip <span class="number">19.00</span>                               </span><br><span class="line">  aria2 <span class="number">1.35</span>.<span class="number">0</span><span class="literal">-1</span>                           </span><br><span class="line">  aria<span class="literal">-ng</span><span class="literal">-gui</span> <span class="number">3.1</span>.<span class="number">0</span> [<span class="type">extras</span>]               </span><br><span class="line">  conemu <span class="number">19.10</span>.<span class="number">12</span> [<span class="type">extras</span>]                 </span><br><span class="line">  conemu<span class="literal">-color</span><span class="literal">-themes</span> ayu<span class="literal">-theme</span> [<span class="type">extras</span>]   </span><br><span class="line">  dismplusplus <span class="number">10.1</span>.<span class="number">1001.10</span> [<span class="type">extras</span>]       </span><br><span class="line">  everything <span class="number">1.4</span>.<span class="number">1.969</span> [<span class="type">extras</span>]            </span><br><span class="line">  ffmpeg <span class="number">4.2</span>.<span class="number">2</span>                             </span><br><span class="line">  firefox <span class="number">75.0</span> [<span class="type">extras</span>]                    </span><br><span class="line">  git <span class="number">2.26</span>.<span class="number">0</span>.windows.<span class="number">1</span>                     </span><br><span class="line">  git<span class="literal">-lfs</span> <span class="number">2.10</span>.<span class="number">0</span>                           </span><br><span class="line">  googlechrome <span class="number">80.0</span>.<span class="number">3987.163</span> [<span class="type">extras</span>]      </span><br><span class="line">  hexo<span class="literal">-blog</span><span class="literal">-client</span> <span class="number">1.2</span>.<span class="number">9</span> [<span class="type">extras</span>]          </span><br><span class="line">  hexo<span class="literal">-client</span> <span class="number">1.3</span>.<span class="number">3</span> [<span class="type">extras</span>]               </span><br><span class="line">  miniconda3 <span class="number">4.7</span>.<span class="number">12.1</span> [<span class="type">extras</span>]             </span><br><span class="line">  nmap <span class="number">7.80</span>                                </span><br><span class="line">  nodejs <span class="number">13.12</span>.<span class="number">0</span>                           </span><br><span class="line">  potplayer <span class="number">200317</span> [<span class="type">extras</span>]                </span><br><span class="line">  qttabbar <span class="number">1038</span> [<span class="type">bear</span>]                     </span><br><span class="line">  steam nightly<span class="literal">-20200408</span> [<span class="type">extras</span>]          </span><br><span class="line">  sublime<span class="literal">-text</span> <span class="number">3.2</span>.<span class="number">2</span><span class="literal">-3211</span> [<span class="type">extras</span>]         </span><br><span class="line">  sudo <span class="number">0.2020</span>.<span class="number">01.26</span>                        </span><br><span class="line">  teamviewer <span class="number">15.4</span>.<span class="number">4445</span> [<span class="type">extras</span>]            </span><br><span class="line">  <span class="built_in">update-qttabbar</span> <span class="number">1040</span> [<span class="type">bear</span>]              </span><br><span class="line">  vcredist2010 <span class="number">10.0</span>.<span class="number">40219</span> [<span class="type">extras</span>]         </span><br><span class="line">  vcredist2019 <span class="number">14.24</span>.<span class="number">28127.4</span> [<span class="type">extras</span>]      </span><br><span class="line">  vlc <span class="number">3.0</span>.<span class="number">8</span> [<span class="type">extras</span>]                       </span><br><span class="line">  vscode<span class="literal">-insiders</span> nightly<span class="literal">-20200408</span> [<span class="type">extras</span>]</span><br><span class="line">  wireshark <span class="number">3.2</span>.<span class="number">2</span> [<span class="type">extras</span>]                 </span><br><span class="line">  youtube<span class="literal">-dl</span> <span class="number">2020.03</span>.<span class="number">24</span>                    </span><br><span class="line">  youtube<span class="literal">-dl</span><span class="literal">-gui</span> <span class="number">0.4</span> [<span class="type">extras</span>]</span><br></pre></td></tr></table></figure>

<p>最好用sudo来执行安装。</p>
<p>scoop安装的包有时候本该加入右键菜单的却没有自动加，而且不像vscode安装完还有提示该执行某个路径下的reg。所以需要手动加入，这里加入一些常用的：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">How to</span><br><span class="line"></span><br><span class="line">Save the code below as foobar.reg and execute it.</span><br><span class="line">Notice ! Modify path !</span><br><span class="line"></span><br><span class="line">    Modify the path to your path! For instance: C:\\Users\\foobar\\scoop\\apps\\git\\current\\git-bash.exe to \\you\\dope\\path\\sth.exe.</span><br><span class="line">    Save the content as .reg file and execute it as administrator.</span><br><span class="line"></span><br><span class="line">Install and Uninstall Context</span><br><span class="line">Sublime-text</span><br><span class="line"></span><br><span class="line">Install:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\*\shell\Open with &amp;Sublime]</span><br><span class="line">@="Open with &amp;Sublime"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\sublime-text\\3211\\sublime_text.exe"</span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\*\shell\Open with &amp;Sublime\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\sublime-text\\3211\\sublime_text.exe\" \"%1\""</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with &amp;Sublime]</span><br><span class="line">@="Open with &amp;Sublime"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\sublime-text\\3211\\sublime_text.exe"</span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with &amp;Sublime\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\sublime-text\\3211\\sublime_text.exe\" \"%1\""</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with &amp;Sublime]</span><br><span class="line">@="Open with &amp;Sublime"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\sublime-text\\3211\\sublime_text.exe"</span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with &amp;Sublime\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\sublime-text\\3211\\sublime_text.exe\" \"%V\""</span><br><span class="line"></span><br><span class="line">Uninstall:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\Open with &amp;Sublime]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\Open with &amp;Sublime\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with &amp;Sublime]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with &amp;Sublime\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with &amp;Sublime]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with &amp;Sublime\command]</span><br><span class="line"></span><br><span class="line">emacs</span><br><span class="line"></span><br><span class="line">Install:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\*\shell\Open with emacs]</span><br><span class="line">@="Open with emacs"</span><br><span class="line">"Icon"="C:\\Users\\foobar\\scoop\\apps\\emacs\\current\\bin\\runemacs.exe"</span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\*\shell\Open with emacs\command]</span><br><span class="line">@="\"C:\\Users\\foobar\\scoop\\apps\\emacs\\current\\bin\\runemacs.exe\" \"%1\""</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with emacs]</span><br><span class="line">@="Open with emacs"</span><br><span class="line">"Icon"="C:\\Users\\foobar\\scoop\\apps\\emacs\\current\\bin\\runemacs.exe"</span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with emacs\command]</span><br><span class="line">@="\"C:\\Users\\foobar\\scoop\\apps\\emacs\\current\\bin\\runemacs.exe\" \"%1\""</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with emacs]</span><br><span class="line">@="Open with emacs"</span><br><span class="line">"Icon"="C:\\Users\\foobar\\scoop\\apps\\emacs\\current\\bin\\runemacs.exe"</span><br><span class="line">[HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with emacs\command]</span><br><span class="line">@="\"C:\\Users\\foobar\\scoop\\apps\\emacs\\current\\bin\\runemacs.exe\" \"%V\""</span><br><span class="line"></span><br><span class="line">Uninstall:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\Open with emacs]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\Open with emacs\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with emacs]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with emacs\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with emacs]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with emacs\command]</span><br><span class="line"></span><br><span class="line">Vim</span><br><span class="line"></span><br><span class="line">Install:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\*\shell\nvim]</span><br><span class="line">@="Open With NVIM"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\neovim\\current\\bin\\nvim-qt.exe"</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\*\shell\nvim\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\neovim\\current\\bin\\nvim-qt.exe\"  \"%1\""</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\nvim]</span><br><span class="line">@="Open With NVIM"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\neovim\\current\\bin\\nvim-qt.exe"</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\nvim\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\neovim\\current\\bin\\nvim-qt.exe\"  \"%V\""</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\shell\nvim]</span><br><span class="line">@="Open With NVIM"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\neovim\\current\\bin\\nvim-qt.exe"</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\shell\nvim\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\neovim\\current\\bin\\nvim-qt.exe\"  \"%1\""</span><br><span class="line"></span><br><span class="line">Unistall:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\Open with NVIM]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\Open with NVIM\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with NVIM]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\Open with NVIM\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with NVIM]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\Open with NVIM\command]</span><br><span class="line"></span><br><span class="line">Git bash</span><br><span class="line"></span><br><span class="line">Inistall:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\shell\git_shell]</span><br><span class="line">@="Git Ba&amp;sh Here"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\git\\current\\git-bash.exe"</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\shell\git_shell\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\git\\current\\git-bash.exe\" \"--cd=%1\""</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\git_shell]</span><br><span class="line">@="Git Ba&amp;sh Here"</span><br><span class="line">"Icon"="C:\\Users\\Notebook\\scoop\\apps\\git\\current\\git-bash.exe"</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\git_shell\command]</span><br><span class="line">@="\"C:\\Users\\Notebook\\scoop\\apps\\git\\current\\git-bash.exe\" \"--cd=%v.\""</span><br><span class="line"></span><br><span class="line">Unistall:</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\git_bash]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\*\shell\git_bash\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\git_bash]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\shell\git_bash\command]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\git_bash]</span><br><span class="line">[-HKEY_CURRENT_USER\Software\Classes\Directory\Background\shell\git_bash\command]</span><br><span class="line"></span><br><span class="line">Difference</span><br><span class="line"></span><br><span class="line">Method 1 you need to edit via regedit to change the value to your git-bash path.</span><br><span class="line"></span><br><span class="line">Method 2 you just edit here and run it.</span><br><span class="line"></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>有一个有用的网站可以检索scoop的包：<a href="https://scoop.if-she.com/" target="_blank" rel="noopener">Scoop App</a></p>
<p>最后可以安装<a href="https://chocolatey.org/install" target="_blank" rel="noopener">chocolatey</a>来和scoop互相补充:<br>管理员权限的powershell中执行：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Bypass <span class="literal">-Scope</span> <span class="keyword">Process</span> <span class="literal">-Force</span>; [<span class="type">System.Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">System.Net.ServicePointManager</span>]::SecurityProtocol <span class="operator">-bor</span> <span class="number">3072</span>; iex ((<span class="built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="string">'https://chocolatey.org/install.ps1'</span>))</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>WTG</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
</search>
